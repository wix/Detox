<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="682px" preserveAspectRatio="none" style="width:962px;height:682px;background:#FFFFFF;" version="1.1" viewBox="0 0 962 682" width="962px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="470.9688" style="stroke:#181818;stroke-width:1.0;" width="10" x="177.5" y="112.7988"/><rect fill="#FFFFFF" height="441.6582" style="stroke:#181818;stroke-width:1.0;" width="10" x="330.5" y="142.1094"/><rect fill="#FFFFFF" height="332.416" style="stroke:#181818;stroke-width:1.0;" width="10" x="474.5" y="230.041"/><rect fill="#FFFFFF" height="220.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="635" y="342.2832"/><rect fill="#FFFFFF" height="234.4844" style="stroke:#181818;stroke-width:1.0;" width="10" x="842" y="283.6621"/><rect height="310.416" style="stroke:#000000;stroke-width:1.5;fill:none;" width="823" x="133.5" y="245.041"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="23" x2="23" y1="81.4883" y2="601.7676"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="182.5" x2="182.5" y1="81.4883" y2="601.7676"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="335.5" x2="335.5" y1="81.4883" y2="601.7676"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="479.5" x2="479.5" y1="81.4883" y2="601.7676"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="639.5" x2="639.5" y1="81.4883" y2="601.7676"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="846.5" x2="846.5" y1="81.4883" y2="601.7676"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="78.5352">User</text><ellipse cx="23.5" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.5,21.5 L23.5,48.5 M10.5,29.5 L36.5,29.5 M23.5,48.5 L10.5,63.5 M23.5,48.5 L36.5,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="614.3027">User</text><ellipse cx="23.5" cy="625.7559" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.5,633.7559 L23.5,660.7559 M10.5,641.7559 L36.5,641.7559 M23.5,660.7559 L10.5,675.7559 M23.5,660.7559 L36.5,675.7559 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="143.5" y="78.5352">Jest (main)</text><path d="M162,37 L162,61 M162,49 L179,49 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="191" cy="49" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="143.5" y="614.3027">Jest (main)</text><path d="M162,621.2559 L162,645.2559 M162,633.2559 L179,633.2559 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="191" cy="633.2559" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="162" x="254.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148" x="261.5" y="70.5352">DetoxPrimaryContext</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="162" x="254.5" y="600.7676"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148" x="261.5" y="621.3027">DetoxPrimaryContext</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="426.5" y="78.5352">Jest (worker N)</text><path d="M459,37 L459,61 M459,49 L476,49 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="488" cy="49" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="426.5" y="614.3027">Jest (worker N)</text><path d="M459,621.2559 L459,645.2559 M459,633.2559 L476,633.2559 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="488" cy="633.2559" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="195" x="542.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181" x="549.5" y="70.5352">DetoxSecondaryContext.N</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="195" x="542.5" y="600.7676"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181" x="549.5" y="621.3027">DetoxSecondaryContext.N</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="199" x="747.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="185" x="754.5" y="70.5352">DetoxCircusEnvironment.N</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="199" x="747.5" y="600.7676"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="185" x="754.5" y="621.3027">DetoxCircusEnvironment.N</text><rect fill="#FFFFFF" height="470.9688" style="stroke:#181818;stroke-width:1.0;" width="10" x="177.5" y="112.7988"/><rect fill="#FFFFFF" height="441.6582" style="stroke:#181818;stroke-width:1.0;" width="10" x="330.5" y="142.1094"/><rect fill="#FFFFFF" height="332.416" style="stroke:#181818;stroke-width:1.0;" width="10" x="474.5" y="230.041"/><rect fill="#FFFFFF" height="220.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="635" y="342.2832"/><rect fill="#FFFFFF" height="234.4844" style="stroke:#181818;stroke-width:1.0;" width="10" x="842" y="283.6621"/><polygon fill="#181818" points="165.5,108.7988,175.5,112.7988,165.5,116.7988,169.5,112.7988" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="23.5" x2="171.5" y1="112.7988" y2="112.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="30.5" y="108.0566">jest --maxWorkers N</text><polygon fill="#181818" points="318.5,138.1094,328.5,142.1094,318.5,146.1094,322.5,142.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="187.5" x2="324.5" y1="142.1094" y2="142.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="194.5" y="137.3672">require('detox')</text><polygon fill="#181818" points="318.5,167.4199,328.5,171.4199,318.5,175.4199,322.5,171.4199" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="187.5" x2="324.5" y1="171.4199" y2="171.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="194.5" y="166.6777">resolveConfig()</text><polygon fill="#181818" points="318.5,196.7305,328.5,200.7305,318.5,204.7305,322.5,200.7305" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="187.5" x2="324.5" y1="200.7305" y2="200.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="194.5" y="195.9883">init()</text><polygon fill="#181818" points="462.5,226.041,472.5,230.041,462.5,234.041,466.5,230.041" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="187.5" x2="468.5" y1="230.041" y2="230.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="194.5" y="225.2988">child_process.fork()</text><path d="M133.5,245.041 L207.5,245.041 L207.5,252.3516 L197.5,262.3516 L133.5,262.3516 L133.5,245.041 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="310.416" style="stroke:#000000;stroke-width:1.5;" width="823" x="133.5" y="245.041"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="148.5" y="258.6094">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="85" x="222.5" y="257.6758">[every test file]</text><polygon fill="#181818" points="830,279.6621,840,283.6621,830,287.6621,834,283.6621" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="484.5" x2="836" y1="283.6621" y2="283.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="491.5" y="278.9199">new()</text><polygon fill="#181818" points="830,308.9727,840,312.9727,830,316.9727,834,312.9727" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="484.5" x2="836" y1="312.9727" y2="312.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="491.5" y="308.2305">setup()</text><polygon fill="#181818" points="656,338.2832,646,342.2832,656,346.2832,652,342.2832" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="650" x2="841" y1="342.2832" y2="342.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="662" y="337.541">require('detox')</text><polygon fill="#181818" points="656,367.5938,646,371.5938,656,375.5938,652,371.5938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="650" x2="841" y1="371.5938" y2="371.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="662" y="366.8516">init()</text><polygon fill="#181818" points="656,396.9043,646,400.9043,656,404.9043,652,400.9043" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="650" x2="841" y1="400.9043" y2="400.9043"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="662" y="396.1621">installWorker()</text><polygon fill="#181818" points="351.5,426.2148,341.5,430.2148,351.5,434.2148,347.5,430.2148" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="345.5" x2="634" y1="430.2148" y2="430.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="357.5" y="425.4727">register worker</text><polygon fill="#181818" points="830,455.5254,840,459.5254,830,463.5254,834,459.5254" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="484.5" x2="836" y1="459.5254" y2="459.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="491.5" y="454.7832">run test file</text><polygon fill="#181818" points="830,484.8359,840,488.8359,830,492.8359,834,488.8359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="484.5" x2="836" y1="488.8359" y2="488.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="491.5" y="484.0938">teardown()</text><polygon fill="#181818" points="656,514.1465,646,518.1465,656,522.1465,652,518.1465" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="650" x2="846" y1="518.1465" y2="518.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="662" y="513.4043">uninstallWorker()</text><polygon fill="#181818" points="318.5,543.457,328.5,547.457,318.5,551.457,322.5,547.457" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="187.5" x2="324.5" y1="547.457" y2="547.457"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="194.5" y="542.7148">reportTestResults()</text><polygon fill="#181818" points="323.5,579.7676,333.5,583.7676,323.5,587.7676,327.5,583.7676" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="182.5" x2="329.5" y1="583.7676" y2="583.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="189.5" y="579.0254">cleanup()</text><!--MD5=[0ed9f123cd3a265b87e1318156de72cf]
@startuml

actor User
boundary "Jest (main)" as Jest0
participant "DetoxPrimaryContext" as Pri
boundary "Jest (worker N)" as JestN
participant "DetoxSecondaryContext.N" as Sec
participant "DetoxCircusEnvironment.N" as Env

User -> Jest0: jest - -maxWorkers N
activate Jest0
Jest0 -> Pri: require('detox')
activate Pri
Jest0 -> Pri: resolveConfig()
Jest0 -> Pri: init()
Jest0 -> JestN: child_process.fork()
activate JestN
loop every test file
  JestN -> Env: new()
  activate Env
  JestN -> Env: setup()
  Env -> Sec: require('detox')
  activate Sec
  Env -> Sec: init()
  Env -> Sec: installWorker()
  Sec - -> Pri: register worker
  JestN -> Env: run test file
  JestN -> Env: teardown()
  Env -> Sec: uninstallWorker()
  deactivate Env
  Jest0 - -> Pri: reportTestResults()
end loop
deactivate Sec
deactivate JestN
Jest0 -> Pri: cleanup()
deactivate Pri
deactivate Jest0

@enduml

PlantUML version 1.2022.6(Tue Jun 21 20:34:49 EEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: UA
--></g></svg>