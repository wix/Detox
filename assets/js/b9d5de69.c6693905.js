"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[8271],{8057:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>c,frontMatter:()=>a,metadata:()=>l,toc:()=>g});var t=o(58168),i=(o(96540),o(15680)),s=o(26600);const a={},r="Session",l={unversionedId:"config/session",id:"config/session",title:"Session",description:"It is not recommended to customize this section unless you are debugging native code",source:"@site/../docs/config/session.mdx",sourceDirName:"config",slug:"/config/session",permalink:"/Detox/docs/next/config/session",draft:!1,editUrl:"https://github.com/wix/Detox/edit/master/docs/../docs/config/session.mdx",tags:[],version:"current",frontMatter:{},sidebar:"apiSidebar",previous:{title:"Logger",permalink:"/Detox/docs/next/config/logger"},next:{title:"Test runner",permalink:"/Detox/docs/next/config/testRunner"}},d={},g=[{value:"Location",id:"location",level:2},{value:"Properties",id:"properties",level:2},{value:"<code>session.server</code> [string]",id:"sessionserver-string",level:3},{value:"<code>session.sessionId</code> [string]",id:"sessionsessionid-string",level:3},{value:"<code>session.autoStart</code> [boolean]",id:"sessionautostart-boolean",level:3},{value:"<code>session.debugSynchronization</code> [number]",id:"sessiondebugsynchronization-number",level:3}],p={toc:g},u="wrapper";function c({components:e,...n}){return(0,i.yg)(u,(0,t.A)({},p,n,{components:e,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"session"},"Session"),(0,i.yg)("admonition",{title:"Note",type:"info"},(0,i.yg)("p",{parentName:"admonition"},"It is not recommended to customize this section unless ",(0,i.yg)("a",{parentName:"p",href:"/Detox/docs/next/introduction/debugging"},"you are debugging native code"),"\nor contributing to the native iOS/Android code of Detox.")),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"session")," section tells Detox how to set up its web socket server and client. They are used to forward the JSON-serialized expectations and element interactions to the native implementation of Detox side-loaded with the app."),(0,i.yg)("h2",{id:"location"},"Location"),(0,i.yg)(s.Ay,{sectionName:"session",mdxType:"Location"}),(0,i.yg)("h2",{id:"properties"},"Properties"),(0,i.yg)("p",null,"There is one important thing to note when you\u2019ll be defining a session config, e.g.:"),(0,i.yg)("h3",{id:"sessionserver-string"},(0,i.yg)("inlineCode",{parentName:"h3"},"session.server")," ","[","string]"),(0,i.yg)("p",null,"Default: ",(0,i.yg)("inlineCode",{parentName:"p"},"ws://localhost:{randomPort}"),"."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "session": {\n// highlight-next-line\n    "server": "ws://localhost:8099"\n  }\n}\n')),(0,i.yg)("p",null,"When you define a URL for ",(0,i.yg)("inlineCode",{parentName:"p"},"server"),", it automatically sets ",(0,i.yg)("a",{parentName:"p",href:"#sessionautostart-boolean"},(0,i.yg)("inlineCode",{parentName:"a"},"session.autoStart"))," to ",(0,i.yg)("em",{parentName:"p"},"false")," (mainly due to backward compatibility reasons), so make sure to override it back if you didn\u2019t intend that."),(0,i.yg)("h3",{id:"sessionsessionid-string"},(0,i.yg)("inlineCode",{parentName:"h3"},"session.sessionId")," ","[","string]"),(0,i.yg)("p",null,"Default: a random UUID, e.g. ",(0,i.yg)("inlineCode",{parentName:"p"},"7731871e-2f07-46bb-acbc-cb0eb6a0ace7"),"."),(0,i.yg)("p",null,"Since the Detox server is a single entity, but there can be multiple test workers running multiple devices and apps,\nit needs to understand which connection belongs to which app."),(0,i.yg)("p",null,"Detox forwards ",(0,i.yg)("inlineCode",{parentName:"p"},"sessionId")," to the app as a launch argument, so the app immediately knows where to connect to."),(0,i.yg)("admonition",{type:"caution"},(0,i.yg)("p",{parentName:"admonition"},"Defining an explicit ",(0,i.yg)("inlineCode",{parentName:"p"},"sessionId")," means you cannot use ",(0,i.yg)("strong",{parentName:"p"},"multiple workers"),",\nsince the specified session will become busy for any test worker next to the first one to occupy it."),(0,i.yg)("pre",{parentName:"admonition"},(0,i.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "session": {\n    "server": "ws://localhost:8099",\n// highlight-next-line\n    "sessionId": "YourProjectSessionId"\n  }\n}\n'))),(0,i.yg)("h3",{id:"sessionautostart-boolean"},(0,i.yg)("inlineCode",{parentName:"h3"},"session.autoStart")," ","[","boolean]"),(0,i.yg)("p",null,"Default: ",(0,i.yg)("inlineCode",{parentName:"p"},"true")," for undefined ",(0,i.yg)("inlineCode",{parentName:"p"},"session.server"),", and ",(0,i.yg)("inlineCode",{parentName:"p"},"false")," for defined."),(0,i.yg)("p",null,"Controls whether Detox web socket server will be starting automatically.\nIf ",(0,i.yg)("inlineCode",{parentName:"p"},"false"),", it is assumed that you will be running it independently via ",(0,i.yg)("a",{parentName:"p",href:"/Detox/docs/next/cli/run-server"},(0,i.yg)("inlineCode",{parentName:"a"},"detox run-server"))," CLI command."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-diff"},'   "session": {\n+    "autoStart": true,\n     "server": "ws://localhost:8099",\n     "sessionId": "YourProjectSessionId"\n')),(0,i.yg)("h3",{id:"sessiondebugsynchronization-number"},(0,i.yg)("inlineCode",{parentName:"h3"},"session.debugSynchronization")," ","[","number]"),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Enabled by default"),", with the value of ",(0,i.yg)("inlineCode",{parentName:"p"},"10_000"),"ms."),(0,i.yg)("p",null,"Tells Detox how long (in milliseconds) to wait for the app to become idle until it starts querying it for more details in order to print out automated-synchronization debugging logs."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "session": {\n    "debugSynchronization": 5000\n  }\n}\n')),(0,i.yg)("p",null,"Detox will be printing the list of busy idling resources every time an action takes more than the specified period, e.g.:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-plain",metastring:"text",text:!0},'09:41:00.941 detox[1337] i The app is busy with the following tasks:\n\u2022 There are 10 work items pending on the dispatch queue: "Main Queue (<OS_dispatch_queue_main: com.apple.main-thread>)".\n\u2022 UI elements are busy:\n  - Layers pending animations: 96.\n  - Layers needs layout: 173.\n  - View needs layout: 74.\n  - View needs display: 98.\n  - Layers needs display: 90.\n\u2022 Run loop "Main Run Loop" is awake.\n')),(0,i.yg)("sup",null,"(These are logs generated by Detox for iOS; Detox for Android generates different yet equivalent ones)"),(0,i.yg)("p",null,"To disable this behavior (i.e. querying the app periodically), set the value to ",(0,i.yg)("inlineCode",{parentName:"p"},"0"),"."),(0,i.yg)("p",null,"Seeing logs like these usually indicates certain issues in your application, as explained in the ",(0,i.yg)("a",{parentName:"p",href:"/Detox/docs/next/troubleshooting/synchronization"},"Troubleshooting Guide"),"."),(0,i.yg)("p",null,"For extended, more detailed information on iOS, refer to the ",(0,i.yg)("inlineCode",{parentName:"p"},"DetoxSync")," project's ",(0,i.yg)("a",{parentName:"p",href:"https://github.com/wix-incubator/DetoxSync/blob/master/StatusDocumentation.md"},"Status Documentation"),"."))}c.isMDXComponent=!0},26600:(e,n,o)=>{o.d(n,{Ay:()=>l});var t=o(58168),i=(o(96540),o(15680)),s=o(22355);const a={toc:[]},r="wrapper";function l({components:e,...n}){return(0,i.yg)(r,(0,t.A)({},a,n,{components:e,mdxType:"MDXLayout"}),(0,i.yg)("p",null,"You can define the ",(0,i.yg)("code",null,n.sectionName)," config section in two ways: ",(0,i.yg)("i",null,"globally")," and ",(0,i.yg)("i",null,"locally")," (per a configuration):"),(0,i.yg)(s.A,{title:".detoxrc.js",language:"javascript",mdxType:"CodeBlock"},["/** @type {Detox.DetoxConfig} */","module.exports = {","// highlight-start",`  ${n.sectionName}: {`,"    /* global section */","  },","// highlight-end","  devices: { /* \u2026 */ },","  apps: { /* \u2026 */ },","  configurations: {","    'ios.sim.debug': {","      device: 'iphone',","      app: 'ios.debug',","// highlight-start",`      ${n.sectionName}: {`,"        /* local (per-configuration) section */","      },","// highlight-end","    },","  },","};"].join("\n")))}l.isMDXComponent=!0}}]);