"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[4651],{15680:(e,t,n)=>{n.d(t,{xA:()=>p,yg:()=>g});var i=n(96540);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function r(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),c=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef(function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=r(e,["components","mdxType","originalType","parentName"]),u=c(n),d=a,g=u["".concat(l,".").concat(d)]||u[d]||m[d]||o;return n?i.createElement(g,s(s({ref:t},p),{},{components:n})):i.createElement(g,s({ref:t},p))});function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,s=new Array(o);s[0]=d;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=e,r[u]="string"==typeof e?e:a,s[1]=r;for(var c=2;c<o;c++)s[c]=n[c];return i.createElement.apply(null,s)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},91724:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>m,frontMatter:()=>o,metadata:()=>r,toc:()=>c});var i=n(58168),a=(n(96540),n(15680));const o={},s="Testing WebViews",r={unversionedId:"guide/testing-webviews",id:"guide/testing-webviews",title:"Testing WebViews",description:"In this tutorial, we'll go over how you can test a WebView in React Native applications using Detox. We will cover how to engage with web elements in both single and multi WebView scenarios, apply matchers, and execute actions.",source:"@site/../docs/guide/testing-webviews.md",sourceDirName:"guide",slug:"/guide/testing-webviews",permalink:"/Detox/docs/next/guide/testing-webviews",draft:!1,editUrl:"https://github.com/wix/Detox/edit/master/docs/../docs/guide/testing-webviews.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Using TypeScript",permalink:"/Detox/docs/next/guide/typescript"},next:{title:"Using Genymotion SaaS",permalink:"/Detox/docs/next/guide/genymotion-saas"}},l={},c=[{value:"Step 0: Setting Up Detox",id:"step-0-setting-up-detox",level:2},{value:"Step 1: Locating the WebView",id:"step-1-locating-the-webview",level:2},{value:"Single WebView Scenario",id:"single-webview-scenario",level:3},{value:"Multiple Web Views Scenario",id:"multiple-web-views-scenario",level:3},{value:"Using <code>atIndex</code>",id:"using-atindex",level:4},{value:"Step 2: Finding Inner Elements",id:"step-2-finding-inner-elements",level:2},{value:"Bypass CORS Restrictions (iOS Only)",id:"bypass-cors-restrictions-ios-only",level:3},{value:"Step 3: Perform Actions",id:"step-3-perform-actions",level:2},{value:"Perform Custom Actions (<code>runScript</code>)",id:"perform-custom-actions-runscript",level:3},{value:"Step 4: Assert on Expected Behaviour",id:"step-4-assert-on-expected-behaviour",level:2},{value:"Full Example",id:"full-example",level:2}],p={toc:c},u="wrapper";function m({components:e,...t}){return(0,a.yg)(u,(0,i.A)({},p,t,{components:e,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"testing-webviews"},"Testing WebViews"),(0,a.yg)("p",null,"In this tutorial, we'll go over how you can test a WebView in React Native applications using Detox. We will cover how to engage with web elements in both single and multi WebView scenarios, apply matchers, and execute actions."),(0,a.yg)("p",null,"WebViews are crucial parts in a lot of mobile applications, rendering content like web pages or PDF documents within the native environment. However, because the content inside WebViews is web content and not native, it isn't straightforward to interact with using Detox. But fear not, Detox has got you covered with its suite of Web View methods."),(0,a.yg)("admonition",{type:"note"},(0,a.yg)("p",{parentName:"admonition"},"This guide provides an overview of testing web views within React Native apps with Detox. For complete API details, refer to our ",(0,a.yg)("a",{parentName:"p",href:"/Detox/docs/next/api/webviews"},"WebView API documentation"),".")),(0,a.yg)("h2",{id:"step-0-setting-up-detox"},"Step 0: Setting Up Detox"),(0,a.yg)("p",null,"The first thing you'll need is to have your Detox environment properly set up. If you need a hand with that, you can follow the set-up guide ",(0,a.yg)("a",{parentName:"p",href:"/Detox/docs/next/introduction/environment-setup"},"here"),"."),(0,a.yg)("h2",{id:"step-1-locating-the-webview"},"Step 1: Locating the WebView"),(0,a.yg)("p",null,"Detox provides two approaches for locating the host web view and its inner elements, depending on the number of WebViews on the screen."),(0,a.yg)("h3",{id:"single-webview-scenario"},"Single WebView Scenario"),(0,a.yg)("p",null,"The case of a single WebView on the screen is the most common scenario, and it's the simplest to handle."),(0,a.yg)("p",null,"Detox will automatically locate the web view for you, so you don't need to do anything special to find it.\nIn this case, you can use the ",(0,a.yg)("a",{parentName:"p",href:"/Detox/docs/next/api/webviews#webelementmatcher"},(0,a.yg)("inlineCode",{parentName:"a"},"web.element()"))," function with web element matchers to reference elements inside it, see ",(0,a.yg)("a",{parentName:"p",href:"#step-2-finding-inner-elements"},"next step")," in this guide for further details."),(0,a.yg)("h3",{id:"multiple-web-views-scenario"},"Multiple Web Views Scenario"),(0,a.yg)("p",null,"In scenarios where there are multiple WebViews displayed on the screen, you will have to identify a particular WebView first.\nUse a ",(0,a.yg)("a",{parentName:"p",href:"/Detox/docs/next/api/matchers"},"native matcher")," to do this, same as you would for native elements."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-javascript"},"const myWebView = web(by.id('webview_identifier'));\n")),(0,a.yg)("p",null,"After locating the web view, you can then use the ",(0,a.yg)("inlineCode",{parentName:"p"},"myWebView.element()")," method with web view matchers to locate elements within it. See ",(0,a.yg)("a",{parentName:"p",href:"#step-2-finding-inner-elements"},"next step")," in this guide for further details."),(0,a.yg)("h4",{id:"using-atindex"},"Using ",(0,a.yg)("inlineCode",{parentName:"h4"},"atIndex")),(0,a.yg)("p",null,"It is also possible to locate the web view by applying at-index to the web view matcher in case there are multiple matching web views for the same matcher."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-javascript"},"const myWebView = web(by.id('webview_identifier').atIndex(1));\n")),(0,a.yg)("admonition",{type:"note"},(0,a.yg)("p",{parentName:"admonition"},(0,a.yg)("inlineCode",{parentName:"p"},"atIndex()")," API for WebView matching is currently supported for iOS only. Check our ",(0,a.yg)("a",{parentName:"p",href:"/Detox/docs/next/api/webviews#webnativematcheratindexindexelementmatcher"},"API documentation")," for updates.")),(0,a.yg)("h2",{id:"step-2-finding-inner-elements"},"Step 2: Finding Inner Elements"),(0,a.yg)("p",null,"Element matchers are used to find elements within a web view. The ",(0,a.yg)("a",{parentName:"p",href:"/Detox/docs/next/api/webviews#matchers"},"Detox WebView APIs")," provide various matchers for locating elements within a web view (e.g. ",(0,a.yg)("inlineCode",{parentName:"p"},"by.web.id(id)"),", ",(0,a.yg)("inlineCode",{parentName:"p"},"by.web.className(className)"),", ",(0,a.yg)("inlineCode",{parentName:"p"},"by.web.tag(tag)"),", ",(0,a.yg)("inlineCode",{parentName:"p"},"atIndex(index)")," etc.)."),(0,a.yg)("p",null,"Here are examples of using some of the matchers:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-javascript"},"// Match by ID attribute\nconst elementByID = web.element(by.web.id('identifier'));\n\n// Match by CSS class name attribute\nconst elementByClassName = web.element(by.web.className('className'));\n\n// Match by CSS selector\nconst elementByCSSSelector = web.element(by.web.cssSelector('#cssSelector'));\n\n// Match with index in case of multiple matching elements\nconst elementAtIndex = web.element(by.web.id('identifier').atIndex(1));\n")),(0,a.yg)("h3",{id:"bypass-cors-restrictions-ios-only"},"Bypass CORS Restrictions (iOS Only)"),(0,a.yg)("p",null,"When testing web views, you may encounter Cross-Origin Resource Sharing (CORS) restrictions that prevent you from interacting with elements inside the web view."),(0,a.yg)("p",null,"At the moment, Detox is able to bypass CORS restrictions and other browser security features only on iOS, allowing you to interact with inner elements in cases of CORS restrictions (in most cases)."),(0,a.yg)("p",null,"To bypass CORS restrictions on iOS, you can pass the ",(0,a.yg)("a",{parentName:"p",href:"/Detox/docs/next/api/device#12-detoxdisablewebkitsecuritydisable-webkit-security-ios-only"},(0,a.yg)("inlineCode",{parentName:"a"},"detoxDisableWebKitSecurity")),' launch argument. This argument will disable the WebKit security features, allowing Detox to interact with the WebView in a "Sandbox" environment.'),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-javascript"},"await device.launchApp({ launchArgs: { detoxDisableWebKitSecurity: true } });\n")),(0,a.yg)("h2",{id:"step-3-perform-actions"},"Step 3: Perform Actions"),(0,a.yg)("p",null,"Actions allow you to interact with elements within a web view. The ",(0,a.yg)("a",{parentName:"p",href:"/Detox/docs/next/api/webviews#actions"},"Detox WebView APIs")," provide various actions that can be invoked on inner elements."),(0,a.yg)("p",null,"For example, here's a simple example for filling a login form and press on login button:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-javascript"},"\n// Fill username and password\nawait web.element(by.web.id('username')).typeText('John Doe');\nawait web.element(by.web.id('password')).typeText('123456789');\n\n// Press the login button\nawait web.element(by.web.id('login')).tap();\n\n")),(0,a.yg)("h3",{id:"perform-custom-actions-runscript"},"Perform Custom Actions (",(0,a.yg)("inlineCode",{parentName:"h3"},"runScript"),")"),(0,a.yg)("p",null,"You can also execute custom JavaScript code on the web view using the ",(0,a.yg)("inlineCode",{parentName:"p"},"runScript")," action (see ",(0,a.yg)("a",{parentName:"p",href:"/Detox/docs/next/api/webviews#runscriptscript-args"},"API docs"),").\nThis is useful for scenarios where you need to interact with the web view in a way that isn't covered by the built-in actions, for fetching data, or for triggering custom events."),(0,a.yg)("p",null,"For example, you can use ",(0,a.yg)("inlineCode",{parentName:"p"},"runScript")," to get the font size of a text element:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-javascript"},"// Define the matcher for the inner text element\nconst textElement = web(by.id('webview_identifier')).element(by.web.id('text_element'));\n\n// Get the font size of a text element\nconst fontSize = await textElement.runScript(function get(element) {\n  return element.style.fontSize;\n});\n\n// Use jestExpect to assert the font size\njestExpect(fontSize).toBe('16px');\n")),(0,a.yg)("admonition",{type:"note"},(0,a.yg)("p",{parentName:"admonition"},"Using jest-expectations in Detox tests is possible by importing ",(0,a.yg)("inlineCode",{parentName:"p"},"expect")," API from ",(0,a.yg)("inlineCode",{parentName:"p"},"jest")," package and using it with a separate ",(0,a.yg)("inlineCode",{parentName:"p"},"jestExpect")," variable (as shown in the example below).\nThis is due to the fact that Detox uses its own ",(0,a.yg)("inlineCode",{parentName:"p"},"expect")," API, which is not compatible with jest-expectations."),(0,a.yg)("pre",{parentName:"admonition"},(0,a.yg)("code",{parentName:"pre",className:"language-javascript"},"const jestExpect = require('expect').default;\n"))),(0,a.yg)("h2",{id:"step-4-assert-on-expected-behaviour"},"Step 4: Assert on Expected Behaviour"),(0,a.yg)("p",null,"Expectations are assertions on the state of elements within a WebView."),(0,a.yg)("p",null,"For instance, to verify an element has specific text:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-javascript"},"await expect(web.element(by.web.id('identifier'))).toHaveText('Hello World!');\n")),(0,a.yg)("p",null,"Or to assert an element does not exist:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-javascript"},"await expect(web.element(by.web.id('invalid_identifier'))).not.toExist();\n")),(0,a.yg)("h2",{id:"full-example"},"Full Example"),(0,a.yg)("p",null,"Here's a full example of a test that interacts with a WebView:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-javascript"},"it('should login successfully', async () => {\n    // Assert the welcome message is not visible before login\n    await expect(web.element(by.web.id('welcome_message'))).not.toExist();\n\n    // Fill username and password\n    await web.element(by.web.id('username')).typeText('John Doe');\n    await web.element(by.web.id('password')).typeText('123456789');\n\n    // Press the login button\n    await web.element(by.web.id('login')).tap();\n\n    // Assert the login was successful\n    await expect(web.element(by.web.id('welcome_message'))).toHaveText('Welcome, John Doe!');\n});\n")))}m.isMDXComponent=!0}}]);