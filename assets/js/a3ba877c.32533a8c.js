"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[8081],{15680:(e,t,n)=>{n.d(t,{xA:()=>u,yg:()=>m});var a=n(96540);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},g="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef(function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,p=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),g=s(n),c=i,m=g["".concat(p,".").concat(c)]||g[c]||d[c]||r;return n?a.createElement(m,o(o({ref:t},u),{},{components:n})):a.createElement(m,o({ref:t},u))});function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=c;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[g]="string"==typeof e?e:i,o[1]=l;for(var s=2;s<r;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},53033:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>s});var a=n(58168),i=(n(96540),n(15680));const r={},o="Debugging with Detox REPL",l={unversionedId:"guide/detox-repl",id:"version-20.x/guide/detox-repl",title:"Debugging with Detox REPL",description:"REPL mode is currently only supported when using Jest as the test runner.",source:"@site/versioned_docs/version-20.x/guide/detox-repl.md",sourceDirName:"guide",slug:"/guide/detox-repl",permalink:"/Detox/docs/guide/detox-repl",draft:!1,editUrl:"https://github.com/wix/Detox/edit/master/docs/versioned_docs/version-20.x/guide/detox-repl.md",tags:[],version:"20.x",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Parallel Test Execution",permalink:"/Detox/docs/guide/parallel-test-execution"},next:{title:"Using TypeScript",permalink:"/Detox/docs/guide/typescript"}},p={},s=[{value:"How to activate REPL",id:"how-to-activate-repl",level:2},{value:"Adding Custom Scope",id:"adding-custom-scope",level:2},{value:"Using REPL",id:"using-repl",level:2},{value:"See also",id:"see-also",level:2}],u={toc:s},g="wrapper";function d({components:e,...t}){return(0,i.yg)(g,(0,a.A)({},u,t,{components:e,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"debugging-with-detox-repl"},"Debugging with Detox REPL"),(0,i.yg)("admonition",{title:"Important",type:"caution"},(0,i.yg)("p",{parentName:"admonition"},"REPL mode is currently only supported when using ",(0,i.yg)("strong",{parentName:"p"},"Jest")," as the test runner.")),(0,i.yg)("p",null,"Detox provides an interactive Read-Eval-Print Loop (REPL) that allows you to debug tests in real time. It\u2019s particularly useful when exploring app state, running Detox commands manually, or diagnosing failing tests."),(0,i.yg)("h2",{id:"how-to-activate-repl"},"How to activate REPL"),(0,i.yg)("p",null,"REPL is only available when you pass one of the following CLI flags to ",(0,i.yg)("a",{parentName:"p",href:"/Detox/docs/cli/test"},(0,i.yg)("inlineCode",{parentName:"a"},"detox test"))," command:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("inlineCode",{parentName:"p"},"--repl=auto")),(0,i.yg)("p",{parentName:"li"},"This mode enables ",(0,i.yg)("strong",{parentName:"p"},"automatic entry into REPL")," whenever a test or lifecycle hook fails \u2014 in addition to supporting manual ",(0,i.yg)("inlineCode",{parentName:"p"},"detox.REPL()")," calls.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("inlineCode",{parentName:"p"},"--repl")),(0,i.yg)("p",{parentName:"li"},"Use this mode when you want ",(0,i.yg)("strong",{parentName:"p"},"manual control"),". You must explicitly call ",(0,i.yg)("inlineCode",{parentName:"p"},"await detox.REPL()")," inside your test or lifecycle hooks (e.g. ",(0,i.yg)("inlineCode",{parentName:"p"},"beforeEach"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"afterEach"),", etc.). Detox will pause execution and open an interactive REPL prompt at that point."),(0,i.yg)("pre",{parentName:"li"},(0,i.yg)("code",{parentName:"pre",className:"language-ts"},"it('should debug manually', async () => {\n  await device.launchApp();\n  await element(by.id('login')).tap();\n\n  // Pause here for live debugging\n  await detox.REPL();\n\n  // Resume test after exiting REPL\n});\n")))),(0,i.yg)("admonition",{title:"Technical Note",type:"tip"},(0,i.yg)("p",{parentName:"admonition"},"When you pass ",(0,i.yg)("inlineCode",{parentName:"p"},"--repl")," CLI argument, you disable advanced terminal features which are normally interfering with interactive input. This step is essential for the REPL to function correctly \u2014 without it, interactive commands will be ignored, and you'll see a warning message instead.")),(0,i.yg)("h2",{id:"adding-custom-scope"},"Adding Custom Scope"),(0,i.yg)("p",null,"You can expose additional helpers or variables inside the REPL context:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-ts"},"await detox.REPL({\n  utils,\n  testUser,\n  delay: (ms) => new Promise(res => setTimeout(res, ms)),\n});\n")),(0,i.yg)("p",null,"When you enter the REPL, you will be able to access given variables directly, e.g.:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-text"},"detox> await utils.login(testUser)\ndetox> await delay(1000)\n")),(0,i.yg)("h2",{id:"using-repl"},"Using REPL"),(0,i.yg)("p",null,"Once inside, you can:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Run Detox commands, e.g.: ",(0,i.yg)("inlineCode",{parentName:"li"},"await element(by.id('foo')).tap()")),(0,i.yg)("li",{parentName:"ul"},"Use ",(0,i.yg)("inlineCode",{parentName:"li"},".dumpxml")," to inspect view hierarchy"),(0,i.yg)("li",{parentName:"ul"},"Use ",(0,i.yg)("inlineCode",{parentName:"li"},".pilot")," to run natural language commands (requires ",(0,i.yg)("a",{parentName:"li",href:"/Detox/docs/pilot/testing-with-pilot"},"Detox Pilot"),")"),(0,i.yg)("li",{parentName:"ul"},"Use Node.js REPL commands like ",(0,i.yg)("inlineCode",{parentName:"li"},".exit"),", ",(0,i.yg)("inlineCode",{parentName:"li"},".help"),", ",(0,i.yg)("inlineCode",{parentName:"li"},".editor"),", ",(0,i.yg)("inlineCode",{parentName:"li"},".save"),", etc.")),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-text"},".detox> .help\n.break     Sometimes you get stuck, this gets you out\n.clear     Alias for .break\n.dumpxml   Print view hierarchy XML\n.editor    Enter editor mode\n.exit      Exit the REPL\n.help      Print this help message\n.load      Load JS from a file into the REPL session\n.pilot     Execute natural language command (e.g. .pilot Tap on login button)\n.save      Save all evaluated commands in this REPL session to a file\n")),(0,i.yg)("p",null,"To exit the REPL, either type ",(0,i.yg)("inlineCode",{parentName:"p"},".exit")," or press ",(0,i.yg)("inlineCode",{parentName:"p"},"Ctrl+C")," twice."),(0,i.yg)("h2",{id:"see-also"},"See also"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"/Detox/docs/pilot/testing-with-pilot"},"Detox Pilot")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://nodejs.org/api/repl.html"},"Node.js REPL API"))))}d.isMDXComponent=!0}}]);